# ğŸ’» Tempo AI - æŠ€è¡“ä»•æ§˜æ›¸

**æœ€çµ‚æ›´æ–°**: 2025 å¹´ 12 æœˆ 5 æ—¥  
**å¯¾è±¡èª­è€…**: ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆé–‹ç™ºã«æºã‚ã‚‹é–‹ç™ºè€…  
**ç›®çš„**: å®Ÿè£…è©³ç´°ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã®æŠ€è¡“ä»•æ§˜ã‚’æä¾›

---

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
2. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
3. [API ä»•æ§˜](#apiä»•æ§˜)
4. [ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«](#ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«)
5. [ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
6. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£)
7. [ãƒ†ã‚¹ãƒˆæˆ¦ç•¥](#ãƒ†ã‚¹ãƒˆæˆ¦ç•¥)
8. [CI/CD](#cicd)
9. [ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ](#ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ)
10. [é–‹ç™ºæ¨™æº–](#é–‹ç™ºæ¨™æº–)

---

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å…¨ä½“æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              iOS App (Swift + SwiftUI)            â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ HealthKitManagerâ”‚  â”‚ LocationManager â”‚       â”‚
â”‚  â”‚ APIClient       â”‚  â”‚ Notifications   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚           â†“                    â†“                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚         Models & ViewModels           â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“ HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Cloudflare Workers (Edge Computing)             â”‚
â”‚              Hono Framework                       â”‚
â”‚                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ /health/analyze â”‚  â”‚ /health/status  â”‚       â”‚
â”‚  â”‚ Route           â”‚  â”‚ Route           â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚           â†“                    â†“                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Health Analysis â”‚  â”‚ Weather Service â”‚       â”‚
â”‚  â”‚ Service         â”‚  â”‚ Claude Service  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Claude API   â”‚    â”‚ Open-Meteo   â”‚
â”‚ (Anthropic)  â”‚    â”‚ Weather API  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

1. **iOS App**: HealthKit ãƒ‡ãƒ¼ã‚¿å–å¾— â†’ ä½ç½®æƒ…å ±å–å¾—
2. **API Request**: `/api/health/analyze` ã« POST é€ä¿¡
3. **Health Analysis**: ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
4. **Weather Service**: Open-Meteo API ã‹ã‚‰æ°—è±¡æƒ…å ±å–å¾—
5. **Claude Service**: AI åˆ†æã§ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ
6. **Response**: æ§‹é€ åŒ–ã•ã‚ŒãŸã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ iOS ã¸è¿”å´
7. **iOS Rendering**: SwiftUI ã§ã‚¢ãƒ‰ãƒã‚¤ã‚¹è¡¨ç¤º

---

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### iOS App

| ã‚«ãƒ†ã‚´ãƒª           | æŠ€è¡“              | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€”                     |
| ------------------ | ----------------- | ---------- | ------------------------ |
| è¨€èª               | Swift             | 5.9+       | ã‚¢ãƒ—ãƒªé–‹ç™ºè¨€èª           |
| UI Framework       | SwiftUI           | iOS 16.0+  | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ |
| ãƒ˜ãƒ«ã‚¹ãƒ‡ãƒ¼ã‚¿       | HealthKit         | -          | å¥åº·ãƒ‡ãƒ¼ã‚¿å–å¾—           |
| ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯       | URLSession        | -          | API é€šä¿¡                 |
| ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | UserDefaults      | -          | ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šä¿å­˜         |
| é€šçŸ¥               | UserNotifications | -          | ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥             |
| ä½ç½®æƒ…å ±           | CoreLocation      | -          | å¤©æ°—ãƒ‡ãƒ¼ã‚¿ç”¨ä½ç½®å–å¾—     |

### Cloudflare Workers API

| ã‚«ãƒ†ã‚´ãƒª         | æŠ€è¡“                   | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€”                    |
| ---------------- | ---------------------- | ---------- | ----------------------- |
| ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | Cloudflare Workers     | Latest     | ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å®Ÿè¡Œç’°å¢ƒ    |
| ãƒ©ãƒ³ã‚¿ã‚¤ãƒ        | V8 JavaScript Engine   | Latest     | JavaScript å®Ÿè¡Œ         |
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯   | Hono                   | 4.10+      | è»½é‡ Web ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| è¨€èª             | TypeScript             | 5.9+       | å‹å®‰å…¨ãªé–‹ç™º            |
| ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³   | Zod                    | 4.1+       | ã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³  |
| AI               | Claude API (Anthropic) | Latest     | å¥åº·ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ      |
| å¤©æ°—             | Open-Meteo API         | -          | ç„¡æ–™å¤©æ°—ãƒ‡ãƒ¼ã‚¿          |
| ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ„ãƒ¼ãƒ«   | Wrangler               | 4.51+      | Cloudflare ãƒ‡ãƒ—ãƒ­ã‚¤     |

### é–‹ç™ºãƒ„ãƒ¼ãƒ«

| ã‚«ãƒ†ã‚´ãƒª         | æŠ€è¡“                | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€”                     |
| ---------------- | ------------------- | ---------- | ------------------------ |
| Package Manager  | pnpm                | 9+         | é«˜é€Ÿãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†       |
| Lint/Format      | Biome               | 2.3+       | ESLint + Prettier ä»£æ›¿   |
| Testing          | Vitest              | 4.0+       | é«˜é€Ÿ TypeScript ãƒ†ã‚¹ãƒˆ   |
| Coverage         | @vitest/coverage-v8 | 4.0+       | ã‚«ãƒãƒ¬ãƒƒã‚¸è¨ˆæ¸¬           |
| Mutation Testing | Stryker Mutator     | 8.6+       | ãƒ†ã‚¹ãƒˆå“è³ªæ¤œè¨¼           |
| iOS Lint         | SwiftLint           | Latest     | Swift ã‚³ãƒ¼ãƒ‰å“è³ª         |
| iOS Format       | swift-format        | Latest     | Swift ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ |
| Node.js          | v20 (LTS)           | 20+        | JavaScript å®Ÿè¡Œç’°å¢ƒ      |

---

## ğŸ“¡ API ä»•æ§˜

### ãƒ™ãƒ¼ã‚¹ URL

```
Production: https://tempo-ai-api.your-subdomain.workers.dev
Development: http://localhost:8787
```

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

| Method | Endpoint              | èª¬æ˜                             | èªè¨¼ |
| ------ | --------------------- | -------------------------------- | ---- |
| POST   | `/api/health/analyze` | ãƒ˜ãƒ«ã‚¹ãƒ‡ãƒ¼ã‚¿åˆ†æã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ | ãªã— |
| GET    | `/api/health/status`  | API ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª             | ãªã— |
| GET    | `/`                   | ã‚µãƒ¼ãƒ“ã‚¹æƒ…å ±ã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§ | ãªã— |

### POST /api/health/analyze

**èª¬æ˜**: HealthKit ãƒ‡ãƒ¼ã‚¿ã¨ä½ç½®æƒ…å ±ã‚’åˆ†æã—ã€ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸå¥åº·ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç”Ÿæˆ

**Request Body**:

```typescript
{
  user_id: string              // ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥å­ï¼ˆUUIDï¼‰
  health_data: {
    sleep: {
      duration: number         // ç¡çœ æ™‚é–“ï¼ˆæ™‚ï¼‰
      deep: number            // æ·±ã„ç¡çœ ï¼ˆæ™‚ï¼‰
      rem: number             // REMç¡çœ ï¼ˆæ™‚ï¼‰
      light: number           // æµ…ã„ç¡çœ ï¼ˆæ™‚ï¼‰
      awake: number           // è¦šé†’æ™‚é–“ï¼ˆæ™‚ï¼‰
      efficiency: number      // ç¡çœ åŠ¹ç‡ï¼ˆ0-100%ï¼‰
    }
    hrv: {
      average: number         // HRVå¹³å‡å€¤
      min: number            // HRVæœ€å°å€¤
      max: number            // HRVæœ€å¤§å€¤
    }
    heartRate: {
      resting: number        // å®‰é™æ™‚å¿ƒæ‹æ•°
      average: number        // å¹³å‡å¿ƒæ‹æ•°
      min: number           // æœ€å°å¿ƒæ‹æ•°
      max: number           // æœ€å¤§å¿ƒæ‹æ•°
    }
    activity: {
      steps: number         // æ­©æ•°
      distance: number      // ç§»å‹•è·é›¢ï¼ˆkmï¼‰
      calories: number      // æ¶ˆè²»ã‚«ãƒ­ãƒªãƒ¼
      activeMinutes: number // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚é–“ï¼ˆåˆ†ï¼‰
    }
  }
  location: {
    latitude: number        // ç·¯åº¦
    longitude: number       // çµŒåº¦
  }
  user_profile: {
    age: number
    gender: "male" | "female" | "other" | "prefer_not_to_say"
    goals: string[]
    dietaryPreferences: string
    exerciseHabits: string
    exerciseFrequency: "daily" | "weekly" | "monthly" | "rarely" | "never"
  }
}
```

**Response**:

```typescript
{
  success: boolean
  data: {
    theme: string                    // ä»Šæ—¥ã®ãƒ†ãƒ¼ãƒ
    summary: string                  // å…¨ä½“ã‚µãƒãƒªãƒ¼
    breakfast: {
      recommendation: string
      reason: string
      examples?: string[]
      timing?: string
      avoid?: string[]
    }
    lunch: { /* åŒã˜æ§‹é€  */ }
    dinner: { /* åŒã˜æ§‹é€  */ }
    exercise: {
      recommendation: string
      intensity: "Low" | "Moderate" | "High"
      reason: string
      timing: string
      avoid: string[]
    }
    hydration: {
      target: string
      schedule: {
        morning: string
        afternoon: string
        evening: string
      }
      reason: string
    }
    breathing: {
      technique: string
      duration: string
      frequency: string
      instructions: string[]
    }
    sleep_preparation: {
      bedtime: string
      routine: string[]
      avoid: string[]
    }
    weather_considerations: {
      warnings: string[]
      opportunities: string[]
    }
    priority_actions: string[]
  }
}
```

**ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

```typescript
{
  success: false;
  error: string;
}
```

### GET /api/health/status

**èª¬æ˜**: API ã‚µãƒ¼ãƒ“ã‚¹ã®ç¨¼åƒçŠ¶æ…‹ç¢ºèª

**Response**:

```typescript
{
  success: boolean;
  data: {
    status: "healthy";
    timestamp: string; // ISO 8601å½¢å¼
    services: {
      claude: "available" | "unavailable";
      weather: "available" | "unavailable";
    }
  }
}
```

---

## ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### TypeScript ãƒ‡ãƒ¼ã‚¿å‹

**HealthData ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:

- `sleep`: ç¡çœ ãƒ‡ãƒ¼ã‚¿ï¼ˆæ™‚é–“ã€æ·±åº¦ã€åŠ¹ç‡ãªã©ï¼‰
- `hrv`: å¿ƒæ‹å¤‰å‹•ãƒ‡ãƒ¼ã‚¿ï¼ˆå¹³å‡ã€æœ€å°ã€æœ€å¤§å€¤ï¼‰
- `heartRate`: å¿ƒæ‹æ•°ãƒ‡ãƒ¼ã‚¿ï¼ˆå®‰é™æ™‚ã€å¹³å‡ã€æœ€å¤§ãƒ»æœ€å°å€¤ï¼‰
- `activity`: æ´»å‹•ãƒ‡ãƒ¼ã‚¿ï¼ˆæ­©æ•°ã€è·é›¢ã€ã‚«ãƒ­ãƒªãƒ¼ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–æ™‚é–“ï¼‰

**UserProfile ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:

- å¹´é½¢ã€æ€§åˆ¥ã€å¥åº·ç›®æ¨™
- é£Ÿäº‹ã®å¥½ã¿ã€é‹å‹•ç¿’æ…£
- é‹å‹•é »åº¦ï¼ˆdaily/weekly/monthly/rarely/neverï¼‰

### Swift ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

**iOS ã‚¢ãƒ—ãƒªå´ã®ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«**:

- HealthKit ã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ API ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ã«å¤‰æ›
- Codable ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ JSON ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œ
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ API ã¨ã®å‹æ•´åˆæ€§ã‚’ä¿è¨¼

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**:

- Zod ã‚¹ã‚­ãƒ¼ãƒã«ã‚ˆã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- å‹å®‰å…¨æ€§ã¨ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒã‚§ãƒƒã‚¯ã®ä¸¡æ–¹ã‚’å®Ÿç¾
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è©³ç´°åŒ–

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**:

- HealthKit ãƒ‡ãƒ¼ã‚¿ã®å¦¥å½“æ€§æ¤œè¨¼
- API é€ä¿¡å‰ã®äº‹å‰ãƒã‚§ãƒƒã‚¯

---

## ğŸ›ï¸ ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### Backend (Cloudflare Workers)

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ**:

- `routes/`: API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾©
- `services/`: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ˜ãƒ«ã‚¹åˆ†æã€AI ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€å¤©æ°—ãƒ‡ãƒ¼ã‚¿ï¼‰
- `types/`: TypeScript å‹å®šç¾©
- `utils/`: å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ï¼‰

**ä¸»è¦ã‚µãƒ¼ãƒ“ã‚¹**:

- **health-analysis**: ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»åˆ†æãƒ­ã‚¸ãƒƒã‚¯
- **health-advice**: Claude AI ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ
- **weather**: Open-Meteo å¤©æ°—ãƒ‡ãƒ¼ã‚¿å–å¾—
- **claude**: Claude API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

### Frontend (iOS)

**ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**:

- **HealthKitManager**: HealthKit ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»ç®¡ç†
- **LocationManager**: ä½ç½®æƒ…å ±å–å¾—
- **APIClient**: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ API é€šä¿¡
- **Views**: SwiftUI ãƒ“ãƒ¥ãƒ¼ï¼ˆãƒ›ãƒ¼ãƒ ã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹è©³ç´°ã€æ¨©é™è¨­å®šï¼‰
- **Models**: ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å®šç¾©

### ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ

1. **Presentation Layer** (iOS SwiftUI)

   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
   - çŠ¶æ…‹ç®¡ç†
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³

2. **API Layer** (Cloudflare Workers)

   - HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‡¦ç†
   - ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
   - CORS è¨­å®š

3. **Service Layer** (Business Logic)

   - ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»åˆ†æ
   - å¤–éƒ¨ API é€£æº
   - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«å®Ÿè£…

4. **External APIs**
   - Claude APIï¼ˆAI åˆ†æï¼‰
   - Open-Meteo APIï¼ˆå¤©æ°—ãƒ‡ãƒ¼ã‚¿ï¼‰

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### é€šä¿¡ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **HTTPS å¼·åˆ¶**: å…¨ API é€šä¿¡ã¯ HTTPSï¼ˆTLS 1.3ï¼‰
- **CORS è¨­å®š**: é©åˆ‡ãª Cross-Origin åˆ¶å¾¡
- **API ã‚­ãƒ¼ç®¡ç†**: ç’°å¢ƒå¤‰æ•°ã§ã®é©åˆ‡ãªç®¡ç†

### ãƒ‡ãƒ¼ã‚¿ä¿è­·

- **HealthKit ãƒ‡ãƒ¼ã‚¿**: ãƒ‡ãƒã‚¤ã‚¹ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã€åˆ†ææ™‚ã®ã¿ã‚µãƒ¼ãƒãƒ¼é€ä¿¡
- **å³åº§å‰Šé™¤**: ã‚µãƒ¼ãƒãƒ¼ã§ã®ãƒ‡ãƒ¼ã‚¿å‡¦ç†å¾Œå³åº§ã«å‰Šé™¤
- **å€‹äººè­˜åˆ¥æƒ…å ±**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ ID ã¯ UUIDï¼ˆå€‹äººç‰¹å®šä¸å¯ï¼‰

### ç’°å¢ƒå¤‰æ•°ç®¡ç†

```bash
# backend/.dev.vars
ANTHROPIC_API_KEY=sk-ant-xxx...
NODE_ENV=development
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³

- **ä¾å­˜é–¢ä¿‚ç›£æŸ»**: `pnpm audit`ã«ã‚ˆã‚‹è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
- **Trivy**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³
- **GitHub Actions**: è‡ªå‹•ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### Backend Testing

**ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Vitest
**ã‚«ãƒãƒ¬ãƒƒã‚¸**: @vitest/coverage-v8
**ç›®æ¨™ã‚«ãƒãƒ¬ãƒƒã‚¸**: 80%ä»¥ä¸Š

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pnpm run test

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆ
pnpm run test:coverage

# ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰
pnpm run test:watch
```

**ãƒ†ã‚¹ãƒˆæ§‹æˆ**:

- **Unit Tests**: ã‚µãƒ¼ãƒ“ã‚¹å±¤ã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã®ãƒ†ã‚¹ãƒˆ
- **Integration Tests**: API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®çµåˆãƒ†ã‚¹ãƒˆ
- **API Tests**: å®Ÿéš›ã®å¤–éƒ¨ API ã‚’ä½¿ç”¨ã—ãŸæ¤œè¨¼ï¼ˆã‚³ã‚¹ãƒˆç™ºç”Ÿï¼‰

### iOS Testing

**ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: XCTest
**ã‚«ãƒãƒ¬ãƒƒã‚¸**: Xcode å†…è”µã‚«ãƒãƒ¬ãƒƒã‚¸

```bash
# iOS ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆCIï¼‰
cd ios
./scripts/quality-check.sh
```

**ãƒ†ã‚¹ãƒˆæ§‹æˆ**:

- **Unit Tests**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
- **UI Tests**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
- **Integration Tests**: HealthKitã€API é€šä¿¡

### ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ

**ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Stryker Mutator
**ç›®æ¨™ã‚¹ã‚³ã‚¢**: 70%ä»¥ä¸Š

```bash
# ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pnpm run test:mutation
```

---

## ğŸš€ CI/CD

### GitHub Actions æ§‹æˆ

#### 1. ci.yml - ãƒ¡ã‚¤ãƒ³ CI çµ±æ‹¬

- Backend CI å‘¼ã³å‡ºã—
- iOS CI å‘¼ã³å‡ºã—
- ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆçµ±åˆ

#### 2. backend.yml - TypeScript Backend CI

**å®Ÿè¡Œå†…å®¹**:

- pnpm ã‚’ä½¿ç”¨ã—ãŸä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- TypeScript å‹ãƒã‚§ãƒƒã‚¯
- Biome ã«ã‚ˆã‚‹ lint + format ãƒã‚§ãƒƒã‚¯
- Vitest ã«ã‚ˆã‚‹ ãƒ†ã‚¹ãƒˆ + ã‚«ãƒãƒ¬ãƒƒã‚¸è¨ˆæ¸¬
- ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰æ¤œè¨¼

#### 3. ios.yml - iOS CI

- SwiftLint é™çš„è§£æ
- swift-format ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- Xcode ãƒ“ãƒ«ãƒ‰æ¤œè¨¼
- å˜ä½“ãƒ†ã‚¹ãƒˆãƒ»UI ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

#### 4. security.yml - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³

- ä¾å­˜é–¢ä¿‚ç›£æŸ»
- Trivy ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¹ã‚­ãƒ£ãƒ³
- è„†å¼±æ€§ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

#### 5. coverage.yml - ã‚«ãƒãƒ¬ãƒƒã‚¸å ±å‘Š

- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸é›†è¨ˆ
- GitHub Pages å…¬é–‹
- PR ã‚³ãƒ¡ãƒ³ãƒˆè‡ªå‹•æŠ•ç¨¿

### å“è³ªã‚²ãƒ¼ãƒˆ

**Backend**:

- TypeScript å‹ã‚¨ãƒ©ãƒ¼: 0
- Biome Lint ã‚¨ãƒ©ãƒ¼: 0
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸: â‰¥80%
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§: Critical/High 0

**iOS**:

- SwiftLint è­¦å‘Š: 0
- swift-format ã‚¨ãƒ©ãƒ¼: 0
- ãƒ“ãƒ«ãƒ‰æˆåŠŸå¿…é ˆ
- ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒæˆåŠŸå¿…é ˆ

---

## ğŸ“¦ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### Cloudflare Workers

#### æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
cd backend
pnpm run build
wrangler deploy
```

#### è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ (GitHub Actions)

```bash
git push origin main
# GitHub Actions ãŒè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ
```

#### ç’°å¢ƒè¨­å®š

```bash
# Cloudflareãƒ­ã‚°ã‚¤ãƒ³
wrangler login

# Secretsè¨­å®š
wrangler secret put ANTHROPIC_API_KEY
```

#### wrangler.toml è¨­å®š

**è¨­å®šé …ç›®**:

- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¨ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
- Cloudflare Workers äº’æ›æ€§è¨­å®š
- æœ¬ç•ªç’°å¢ƒãƒ»ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®å®šç¾©

### iOS App

#### é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆ

```bash
# Xcode ã§ç›´æ¥å®Ÿæ©Ÿãƒ‡ãƒ—ãƒ­ã‚¤
open ios/TempoAI/TempoAI.xcodeproj
```

#### App Store æº–å‚™

1. Archive ä½œæˆï¼ˆXcodeï¼‰
2. TestFlight é…å¸ƒ
3. App Store å¯©æŸ»æå‡º

---

## âš™ï¸ é–‹ç™ºæ¨™æº–

### TypeScript/JavaScript

**[CLAUDE.md](../CLAUDE.md)æº–æ‹ **:

- **å‹å®‰å…¨æ€§**: `any`ä½¿ç”¨ç¦æ­¢ã€strict mode å¿…é ˆ
- **é–¢æ•°ã‚¹ã‚¿ã‚¤ãƒ«**: ã‚¢ãƒ­ãƒ¼é–¢æ•°ä½¿ç”¨
- **å‘½åè¦ç´„**: ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã€æ˜ç¤ºçš„ãªå‹å®šç¾©
- **DRY åŸå‰‡**: å…±é€šãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£åŒ–
- **SOLID åŸå‰‡**: å˜ä¸€è²¬ä»»ã€ä¾å­˜æ€§é€†è»¢

### ã‚³ãƒ¼ãƒ‰å“è³ªãƒ„ãƒ¼ãƒ«

**Biome è¨­å®š**:

- ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚¹ã‚¿ã‚¤ãƒ«: ã‚¹ãƒšãƒ¼ã‚¹ 2 å€‹
- Lint ãƒ«ãƒ¼ãƒ«: `any` ä½¿ç”¨ç¦æ­¢ã€æœªä½¿ç”¨å¤‰æ•°ã‚¨ãƒ©ãƒ¼
- ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè‡ªå‹•é©ç”¨

### Swift

**SwiftLint è¨­å®š**:

- è¡Œé•·åˆ¶é™ç„¡åŠ¹åŒ–
- å¼·åˆ¶ã‚¢ãƒ³ãƒ©ãƒƒãƒ—ã®è­¦å‘Šæœ‰åŠ¹åŒ–
- Pods ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé™¤å¤–

### ã‚³ãƒŸãƒƒãƒˆæ¨™æº–

**ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å½¢å¼**:

- `feat`: æ–°æ©Ÿèƒ½è¿½åŠ 
- `fix`: ãƒã‚°ä¿®æ­£
- `docs`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
- `refactor`: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- `test`: ãƒ†ã‚¹ãƒˆè¿½åŠ ãƒ»ä¿®æ­£
- `chore`: é–‹ç™ºç’°å¢ƒãƒ»ãƒ“ãƒ«ãƒ‰é–¢é€£

**ä¾‹**: `feat: add HRV data collection to HealthKitManager`

---

**ğŸ” è©³ç´°æƒ…å ±ãŒå¿…è¦ãªå ´åˆã¯ã€å¯¾å¿œã™ã‚‹å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¦ãã ã•ã„**

- **ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆä»•æ§˜**: [tempo-ai-product-spec.md](./tempo-ai-product-spec.md)
- **é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³**: [CLAUDE.md](../CLAUDE.md)
- **Backend å®Ÿè£…**: `backend/src/`
- **iOS å®Ÿè£…**: `ios/TempoAI/TempoAI/`
