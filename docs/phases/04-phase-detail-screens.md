# Phase 4: 詳細画面 UI 設計書

**フェーズ**: 4 / 15  
**Part**: A（iOS UI）  
**前提フェーズ**: Phase 2, 3（ホーム画面）

---

## ⚠️ 実装前必読ドキュメント

**実装を開始する前に、以下のドキュメントを必ず確認してください：**

### 📋 必須参考資料

- **[CLAUDE.md](../../CLAUDE.md)** - 開発ガイドライン・基本原則
- **[AI Prompt Design](../ai-prompt-design.md)** - AI 設計指針
- **[UI Specification](../ui-spec.md)** - UI 設計仕様書
- **[Technical Specification](../technical-spec.md)** - 技術仕様書

### 📱 Swift/iOS 専用資料

- **[UX Concepts & Principles](../../.claude/ux_concepts.md)** - UX 設計原則
- **[Swift Coding Standards](../../.claude/swift-coding-standards.md)** - Swift 開発標準

### ✅ 実装完了後の必須作業

実装完了後は必ず以下を実行してください：

```bash
# リント・フォーマット確認
swiftlint
swift-format --lint --recursive ios/

# テスト実行
swift test
```

---

## このフェーズで実現すること

1. **アドバイス詳細画面**（condition.detail、action_suggestions、closing_message）
2. **今日のトライ詳細画面**（daily_try.detail）
3. **今週のトライ詳細画面**（weekly_try.detail）
4. **画面遷移アニメーション**（右からスライドイン）

---

## 完了条件

- [ ] ホーム画面のアドバイスサマリーカードタップで詳細画面へ遷移
- [ ] 今日のトライカードタップで詳細画面へ遷移
- [ ] 今週のトライカードタップで詳細画面へ遷移
- [ ] 各詳細画面から戻るボタンでホームへ戻れる
- [ ] 画面遷移時に右からスライドインのアニメーション
- [ ] 全画面で Mock データが正しく表示される

---

## 画面一覧

| 画面             | 遷移元                   | 主な表示内容                                |
| ---------------- | ------------------------ | ------------------------------------------- |
| アドバイス詳細   | アドバイスサマリーカード | detail、action_suggestions、closing_message |
| 今日のトライ詳細 | 今日のトライカード       | daily_try.detail                            |
| 今週のトライ詳細 | 今週のトライカード       | weekly_try.detail                           |

---

## 詳細レイアウト図

### アドバイス詳細画面

```
┌─────────────────────────────────────┐
│ [←] 今日のアドバイス                │ ← ナビゲーションバー
├─────────────────────────────────────┤
│                                     │
│ 今日のコンディション                │ ← セクション見出し（見出し中）
│                                     │
│ 昨夜は7時間の良質な睡眠が取れ      │
│ ましたね。深い睡眠が1時間45分と、  │
│ 筋肉の回復に理想的な状態です。      │
│                                     │
│ 今朝のHRVは72msと、過去7日平均     │ ← condition.detail
│ の68msを上回っています。日曜日の   │ ← (改行を尊重して段落分け)
│ アクティブレストが功を奏して、      │
│ 体の回復が十分に進んでいます。      │
│                                     │
│ 今日は晴れて気温も14℃まで上がる    │
│ 予報です。トレーニングに最適な      │
│ コンディションですよ！              │
│                                     │
├─────────────────────────────────────┤
│                                     │
│ 今日のアクション                    │ ← セクション見出し（見出し中）
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 💪 午前中に高強度トレーニング   │ │ ← アクションカード1
│ │                                 │ │
│ │ HRVが高く、睡眠の質も良いため、│ │
│ │ パフォーマンスを最大限発揮でき  │ │
│ │ る状態です。普段より5-10%重量を │ │
│ │ 上げてチャレンジできるはずです。│ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🧘 トレーニング前に動的ストレッチ│ │ ← アクションカード2
│ │                                 │ │
│ │ 月曜日は週末の休養明けで、関節  │ │
│ │ が硬くなりやすいタイミングです。│ │
│ │ 肩甲骨周りを入念に動かして      │ │
│ │ ください。                      │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🍽️ トレーニング後の栄養補給      │ │ ← アクションカード3
│ │                                 │ │
│ │ 30分以内にプロテインと炭水化物を│ │
│ │ 一緒に摂ることで、筋グリコーゲン │ │
│ │ の回復が早まります。            │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│                                     │
│ 今日は心身ともに最高のコンディ      │ ← closing_message
│ ションです。ぜひ全力でチャレンジ    │   (セクション見出しなし)
│ して、充実した一日をお過ごし        │
│ ください。                          │
│                                     │
└─────────────────────────────────────┘
```

### セクション構成

1. **今日のコンディション**

   - `condition.detail` を表示
   - 改行（`\n`）を尊重して段落分け

2. **今日のアクション**

   - `action_suggestions` を縦にリスト表示
   - 各アクションはカード形式
   - アイコン + タイトル + detail

3. **締めのメッセージ**
   - `closing_message` を表示
   - セクション見出しなし、本文のみ

### アクションカードの構成

```
┌─────────────────────────────────────┐
│ 💪 午前中に高強度トレーニング       │ ← アイコン + タイトル
│                                     │
│ HRVが高く、睡眠の質も良いため、    │
│ パフォーマンスを最大限発揮できる    │
│ 状態です。普段より5-10%重量を      │
│ 上げてチャレンジできるはずです。    │ ← detail
└─────────────────────────────────────┘
```

### アイコンマッピング

| icon 値   | 絵文字 |
| --------- | ------ |
| fitness   | 💪     |
| stretch   | 🧘     |
| nutrition | 🍽️     |
| hydration | 💧     |
| rest      | 😴     |
| work      | 💼     |
| sleep     | 🌙     |
| mental    | 🧠     |
| beauty    | ✨     |
| outdoor   | 🚶     |

---

### 今日のトライ詳細画面

```
┌─────────────────────────────────────┐
│ [←] 今日のトライ                    │ ← ナビゲーションバー
├─────────────────────────────────────┤
│                                     │
│             🎯                      │ ← アイコン（大きめ表示）
│                                     │
│        ドロップセット法に挑戦       │ ← タイトル（見出し大）
│                                     │
├─────────────────────────────────────┤ ← 仕切り線
│                                     │
│ 今日のトレーニングで、最後の        │ ← detail本文（改行を尊重）
│ セットにドロップセット法を          │
│ 取り入れてみませんか？              │
│                                     │
│ 限界重量でセットを終えたら、        │
│ すぐに重量を30%落として限界まで    │
│ 追い込む方法です。                  │
│                                     │
│ あなたの今日のHRVと回復状態を      │
│ 見ると、この高強度テクニックに      │
│ 耐えられる体の準備ができています。  │
│                                     │
│ 筋肥大に非常に効果的で、普段と      │
│ 違った刺激を筋肉に与えられます      │
│ よ。ただし週に1-2種目に留めて、    │
│ オーバートレーニングには注意して    │
│ くださいね。                        │
│                                     │
│ ぜひ今日、試してみてください。      │
│                                     │
└─────────────────────────────────────┘
```

### 今週のトライ詳細画面

```
┌─────────────────────────────────────┐
│ [←] 今週のトライ                    │ ← ナビゲーションバー
├─────────────────────────────────────┤
│                                     │
│             📅                      │ ← アイコン（大きめ表示）
│                                     │
│    セサミオイルで足裏マッサージ     │ ← タイトル（見出し大）
│                                     │
├─────────────────────────────────────┤ ← 仕切り線
│                                     │
│ 今週のチャレンジ:                   │ ← detail本文（改行・リストを尊重）
│ セサミオイルで寝る前の足裏          │
│ マッサージ                          │
│                                     │
│ アーユルヴェーダでは、足裏の        │
│ マッサージが深い眠りと自律神経の    │
│ 安定につながるとされています。      │
│                                     │
│ 【やり方】                          │
│ 1. 少量のセサミオイルを手に取り、  │
│    体温で温めます                   │
│ 2. 足裏全体を優しくマッサージ       │
│ 3. 特に土踏まずと指の付け根を       │
│    重点的に                         │
│                                     │
│ 【期待できる効果】                  │
│ ・血行促進とリラックス              │
│ ・睡眠の質の向上                    │
│ ・自律神経の調整                    │
│                                     │
│ 今週、3回以上試してみてください。  │
│                                     │
└─────────────────────────────────────┘
```

## 要素配置詳細

### 共通レイアウト原則
- **ナビゲーションバー**: 戻るボタン（左上）+ 画面タイトル（中央）
- **縦スクロール**: 全体がスクロール可能、ナビゲーションバーは固定
- **タブバー**: 詳細画面では非表示
- **余白**: 大きめの余白でゆったりとした読みやすいレイアウト

### アドバイス詳細画面の構成
1. **今日のコンディション**: condition.detailの内容、段落分けを尊重
2. **今日のアクション**: action_suggestionsを縦配置のカード群で表示
3. **締めのメッセージ**: closing_message、セクション見出しなし

### アクションカードの配置
- **カード間隔**: 中程度のマージン
- **カード内容**: アイコン + タイトル（上部）+ detail（本文）
- **視覚的区切り**: カードの境界で内容を明確に分離

### トライ詳細画面の構成
- **アイコン**: 大きめ表示で視覚的インパクト
- **タイトル**: 見出し大サイズ、中央または左寄せ
- **本文**: 改行・リスト・【】見出しを含む豊富なテキスト表現に対応

---

## 今日のトライ詳細画面

### 構成要素

- **アイコン**: 🎯（大きめに表示）
- **タイトル**: `daily_try.title`（見出し大）
- **詳細**: `daily_try.detail`（改行を尊重）

---

## 今週のトライ詳細画面

### 画面構成

```
┌─────────────────────────────────────┐
│ [←] 今週のトライ                    │
├─────────────────────────────────────┤
│                                     │
│ 📅                                  │
│                                     │
│ セサミオイルで足裏マッサージ        │ ← タイトル
│                                     │
├─────────────────────────────────────┤
│                                     │
│ 今週のチャレンジ:                   │
│ セサミオイルで寝る前の足裏          │
│ マッサージ                          │
│                                     │
│ アーユルヴェーダでは、足裏の        │
│ マッサージが深い眠りと自律神経の    │
│ 安定につながるとされています。      │
│                                     │
│ 【やり方】                          │
│ 1. 少量のセサミオイル...           │
│ 2. 足裏全体を優しく...             │
│ 3. 特に土踏まずと...               │
│                                     │
│ 【期待できる効果】                  │
│ ・血行促進とリラックス              │
│ ・睡眠の質の向上                    │
│ ...                                 │
│                                     │
│ 今週、3回以上試してみてください。  │ ← detail
│                                     │
└─────────────────────────────────────┘
```

### 構成要素

- **アイコン**: 📅（大きめに表示）
- **タイトル**: `weekly_try.title`（見出し大）
- **詳細**: `weekly_try.detail`（改行・リスト表現を尊重）

---

## 画面遷移

### 遷移方向

- **進む**: 右からスライドイン（Push）
- **戻る**: 左へスライドアウト（Pop）

### ナビゲーションバー

- 左上: 戻るボタン（← または chevron.left）
- タイトル: 画面名

### 戻る方法

- 戻るボタンタップ
- 画面左端からの右スワイプ（iOS 標準）

---

## Mock データ

### アドバイス詳細 Mock

```swift
condition:
  detail: """
    昨夜は7時間の良質な睡眠が取れましたね。深い睡眠が1時間45分と、
    筋肉の回復に理想的な状態です。

    今朝のHRVは72msと、過去7日平均の68msを上回っています。
    日曜日のアクティブレストが功を奏して、体の回復が十分に進んでいます。

    今日は晴れて気温も14℃まで上がる予報です。
    トレーニングに最適なコンディションですよ！
    """

action_suggestions:
  - icon: "fitness"
    title: "午前中に高強度トレーニング"
    detail: """
      HRVが高く、睡眠の質も良いため、パフォーマンスを最大限発揮
      できる状態です。普段より5-10%重量を上げてチャレンジできる
      はずです。
      """
  - icon: "stretch"
    title: "トレーニング前に動的ストレッチ"
    detail: """
      月曜日は週末の休養明けで、関節が硬くなりやすいタイミングです。
      肩甲骨周りを入念に動かしてください。
      """
  - icon: "nutrition"
    title: "トレーニング後の栄養補給"
    detail: """
      30分以内にプロテインと炭水化物を一緒に摂ることで、筋グリコ
      ーゲンの回復が早まります。
      """

closing_message: """
  今日は心身ともに最高のコンディションです。ぜひ全力で
  チャレンジして、充実した一日をお過ごしください。
  """
```

### 今日のトライ詳細 Mock

```swift
daily_try:
  title: "ドロップセット法に挑戦"
  detail: """
    今日のトレーニングで、最後のセットにドロップセット法を取り入れて
    みませんか？

    限界重量でセットを終えたら、すぐに重量を30%落として限界まで
    追い込む方法です。

    あなたの今日のHRVと回復状態を見ると、この高強度テクニックに
    耐えられる体の準備ができています。

    筋肥大に非常に効果的で、普段と違った刺激を筋肉に与えられます
    よ。ただし週に1-2種目に留めて、オーバートレーニングには注意して
    くださいね。

    ぜひ今日、試してみてください。
    """
```

---

## 実装コンポーネント

### Views（Features/Home/Views/）

- `AdviceDetailView` - アドバイス詳細画面
- `ActionSuggestionCard` - アクション提案のカード
- `DailyTryDetailView` - 今日のトライ詳細画面
- `WeeklyTryDetailView` - 今週のトライ詳細画面

### Shared Components

- `DetailScreenHeader` - 詳細画面共通のヘッダー（戻るボタン + タイトル）

---

## スクロール動作

各詳細画面:

- 全体が縦スクロール可能
- ナビゲーションバーは上部固定
- タブバーは非表示（詳細画面では隠す）

---

## カラー適用

| 要素                 | カラー             |
| -------------------- | ------------------ |
| 背景                 | Primary Background |
| アクションカード背景 | Card Background    |
| セクション見出し     | Primary Text       |
| 本文                 | Primary Text       |
| 戻るボタン           | Primary Color      |

---

## UI/UX ポイント

### テキスト表示

- 改行（`\n`）を適切に処理して段落分け
- 行間は広めに設定
- 長文でも読みやすく

### アクションカード

- 視覚的に区切られていることを明示
- アイコンで内容を直感的に理解できるように

### 戻る動作

- 戻るボタンは十分な大きさ（タップしやすく）
- スワイプでも戻れることをユーザーに期待させる

---

## 今後のフェーズとの関係

### Phase 5 で追加（コンディション画面）

- ホーム画面のコンディションサマリーカードからコンディション画面への遷移
- コンディション画面はタブとして独立

### Phase 10 で変更

- Mock データを API レスポンスに置き換え

---

## 関連ドキュメント

- `ui-spec.md` - セクション 7「詳細画面群」
- `ai-prompt-design.md` - セクション 2「JSON 出力スキーマ」
- `product-spec.md` - セクション 2「機能要件」

---

## 改訂履歴

| バージョン | 日付       | 変更内容                                           |
| ---------- | ---------- | -------------------------------------------------- |
| 1.0        | 2025-12-10 | 初版作成                                           |
| 1.1        | 2025-12-11 | コンディション画面分離に伴い、メトリクス詳細を削除 |
