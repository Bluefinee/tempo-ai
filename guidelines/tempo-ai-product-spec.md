# 📱 Tempo AI - 製品仕様書 v1.2

**対象**: プロダクトマネージャー、デザイナー、ステークホルダー  
**作成日**: 2024 年 12 月 4 日  
**最終更新**: 2024 年 12 月 5 日  
**バージョン**: 1.2 - HealthKit 拡充・環境データ強化・クイックチェックイン追加

---

## 🎯 プロダクト概要

### コンセプト

Tempo AI は、HealthKit データ、環境情報、ユーザーの日々の体調を統合的に活用し、AI があなたの体調と環境に最適化された健康アドバイスを毎日提供するパーソナル健康アシスタントです。

### ビジョン

「毎朝、あなた専用の健康コーチが最適なアドバイスを届ける世界」

### ターゲットユーザー

- 健康意識の高い 25-40 代
- Apple Watch または iPhone ユーザー
- データドリブンで健康管理したい人
- **グローバル展開**: 日本・北米から開始、世界展開予定

### 対応言語（Phase 1）

- 🇺🇸 **英語**（デフォルト）
- 🇯🇵 **日本語**
- Phase 4 以降: スペイン語、フランス語、ドイツ語、中国語、韓国語

### 提供価値

1. **完全パーソナライズ**: 睡眠、心拍、活動量、天気、環境を総合分析
2. **実行可能**: 具体的で今日すぐ実践できるアドバイス
3. **多言語対応**: ユーザーの母国語で理解しやすいアドバイス
4. **Apple Watch 最適化**: デバイスを自動検出し、より詳細なデータ活用
5. **環境配慮**: 気圧、花粉、大気質を考慮した健康管理
6. **将来拡張**: 血液検査データなどとの統合予定

---

## 📊 収集データ詳細

### 🏥 HealthKit データ

#### Phase 1 で収集（基本 + 拡充）

**既存データ:**

- 睡眠時間・睡眠ステージ（深い睡眠、REM 睡眠など）
- 心拍変動（HRV）
- 心拍数
- 歩数
- 活動カロリー

**Phase 1 で追加:**

- ✅ **安静時心拍数**: 自律神経の状態把握
- ✅ **血中酸素濃度**: 呼吸器系の健康指標
- ✅ **呼吸数**: ストレス・睡眠の質の指標

#### Phase 2 で追加

- **体温**: 体調変化の早期検知（発熱、疲労）
- **マインドフルネス時間**: メンタルケアの習慣把握
- **立ち上がり回数**: 座りすぎの警告
- **運動種別の詳細**: ランニング、筋トレ、ヨガ、サイクリングなど
- **消費カロリー詳細**: 基礎代謝 vs 活動代謝

#### Apple Watch 自動検出

```swift
// アプリ起動時にApple Watchの接続状態を自動判定
if WCSession.default.isPaired && WCSession.default.isWatchAppInstalled {
    // Apple Watch装着時はより詳細なデータを収集
    // - 24時間心拍数トラッキング
    // - 睡眠中の呼吸数
    // - 運動中のリアルタイム心拍
}
```

**Apple Watch 装着時の追加メリット:**

- より精密な睡眠分析（深い睡眠、REM 睡眠の詳細）
- 24 時間心拍数モニタリング
- 運動中のリアルタイムデータ
- より正確なカロリー計算

---

### 🌤️ 環境データ

#### Phase 1 で収集（既存 + 拡充）

**既存データ（Open-Meteo API）:**

- 気温
- 天気（晴れ、曇り、雨など）
- 湿度

**Phase 1 で追加:**

- ✅ **気圧**: 頭痛・体調不良の予測（気圧病対策）
- ✅ **UV 指数**: 日焼け止め・日光浴のアドバイス
- ✅ **日の出/日の入り時刻**: 概日リズム最適化

#### Phase 2 で追加

- **花粉情報**: アレルギー対策アドバイス（地域別）
- **大気質指数（AQI）**: 屋外活動の適切なタイミング提案
- **風速**: 屋外運動の快適性判定

**使用 API:**

- Open-Meteo API（気圧、UV、日の出/入）
- Pollen.com API または Open-Meteo Pollen（花粉情報）
- IQAir API（大気質）

---

### ✅ 朝のクイックチェックイン（Phase 2）

**目的**: AI アドバイスをさらにパーソナライズ

**タイミング**: 毎朝の通知をタップした直後（30 秒で完了）

**入力項目:**

1. **今日の気分**

   ```
   今朝の気分は？
   😊 調子いい  😐 普通  😔 疲れてる
   ```

2. **疲労度**（5 段階スライダー）

   ```
   疲労度: 1 ━━●━━━━━ 5
   ```

3. **睡眠の質感**

   ```
   睡眠の質は？
   ⭐️ ぐっすり  ☁️ 普通  💤 浅い
   ```

4. **前日の飲酒**
   ```
   昨晩お酒を飲みましたか？
   🍺 はい（グラス数: 1 2 3 4+）
   ❌ いいえ
   ```

**UX 設計:**

- スキップ可能（任意入力）
- 1 画面で完結
- タップ・スワイプのみで完了
- データはその日のアドバイス生成に即反映

---

## 📱 アプリ構造

### ナビゲーション: タブバー（4 タブ）

```
┌─────┬─────┬─────┬─────┐
│ 🏠  │ 📅  │ 📈  │ 👤  │
│今日  │履歴  │傾向  │私   │
└─────┴─────┴─────┴─────┘
```

---

## 🖼️ 画面仕様

### 1. ホーム画面（Today） - Phase 1 + Phase 2 拡張

**レイアウト（更新版）:**

```
┌─────────────────────────────┐
│ おはようございます、まさかずさん │
│ 12月5日（木）☀️ 15°C         │
│ ⌚️ Apple Watch connected    │
├─────────────────────────────┤
│  ⚠️ 環境アラート              │
│  気圧が急降下しています        │
│  頭痛に注意 → 詳細           │
├─────────────────────────────┤
│  ┌─────────────────────┐   │
│  │ 今日のテーマ           │
│  │ 「回復優先の日」        │
│  │ 睡眠: 6.5h / HRV: ↓   │
│  │ 安静時心拍: 68 / SpO2: 97% │
│  └─────────────────────┘   │
├─ 今日のアクション ──────────┤
│ 🍳 朝食                      │
│ 抗炎症食品を中心に           │
│ サーモン + ブルーベリー       │
│                             │
│ 💪 運動                      │
│ 軽めのウォーキング 30分      │
│ 気圧低下のため強度控えめ     │
│                             │
│ 💧 水分                      │
│ 今日は2.8L目標              │
│ （気圧対策で多めに）          │
│                             │
│ 🧘 呼吸法                    │
│ 4-7-8呼吸法を5回            │
├─────────────────────────────┤
│    [すべての詳細を見る] >    │
└─────────────────────────────┘
```

**新機能:**

- ✅ Apple Watch 接続状態の表示
- ✅ 環境アラートカード（気圧、花粉、AQI の警告）
- ✅ 拡充されたバイタルデータ表示
- ✅ 環境要因を考慮したアドバイス

---

### 2. 詳細アドバイス画面 - Phase 1 + Phase 2 拡張

**コンテンツ（更新版）:**

```
🍳 朝食
【推奨メニュー】
・サーモン（100g）
・ブルーベリー（1カップ）
・アボカド（半分）
・緑茶

【理由】
気圧が1010hPaから995hPaに急降下しています。
気圧低下時は血管が拡張し、頭痛が起きやすくなります。
オメガ3脂肪酸（サーモン）とポリフェノール（ブルーベリー）
で抗炎症作用を高め、マグネシウム（アボカド）で
血管の緊張を和らげましょう。

━━━━━━━━━━━━━━━━━━━

☀️ 環境に基づくアドバイス

【気圧】
・現在: 995hPa（24時間で-15hPa）
・影響: 頭痛、めまい、関節痛のリスク
・対策:
  - 水分を多めに（血流改善）
  - マグネシウム豊富な食材
  - 無理な予定は避ける

【UV指数】
・レベル: 3（中程度）
・対策: 日焼け止め推奨（SPF30+）
・日光浴: 10-15分で十分なビタミンD合成

【日の出/入】
・日の出: 6:42
・日の入: 16:28
・推奨: 朝7時前に15分の朝日を浴びる
  → 概日リズムをリセット

━━━━━━━━━━━━━━━━━━━

💪 今日の運動
【推奨】
軽めのウォーキング 30分
心拍数: 100-120bpm程度

【理由】
- HRVが昨日より10%低下
- 気圧低下で体調不安定
- 安静時心拍が通常より5高い
  → 回復モード推奨

【避けるべき運動】
・HIIT
・重量挙げ
・長時間の有酸素運動

━━━━━━━━━━━━━━━━━━━

🧘 呼吸法・ストレッチ
【4-7-8呼吸法】（気圧対策版）
1. 4秒かけて鼻から吸う
2. 7秒息を止める
3. 8秒かけて口から吐く
4. 5回繰り返す（通常より多め）

【理由】
気圧低下時は自律神経が乱れやすいため、
深呼吸で副交感神経を活性化しましょう。

━━━━━━━━━━━━━━━━━━━

💧 水分補給
今日の目標: 2.8L（通常より+300ml）

【タイミング】
起床後: 500ml（レモン水推奨）
午前中: 600ml
昼食時: 300ml
午後: 600ml
夕食時: 300ml
就寝前: 200ml

【理由】
気圧低下時は血流が悪くなりやすいため、
水分を多めに摂取して血液をサラサラに保ちましょう。

━━━━━━━━━━━━━━━━━━━

🌙 夜の過ごし方
・20時までに夕食
・21時に入浴（38-40°C、15分）
  → 自律神経を整える
・22:30 就寝準備開始
  → 日の入りから6時間後（概日リズム最適）
・23時就寝目標
```

---

### 3. クイックチェックイン画面（Phase 2 新規）

**フロー:**

```
通知タップ
  ↓
クイックチェックイン画面（30秒）
  ↓
データ分析開始
  ↓
ホーム画面
```

**画面デザイン:**

```
┌─────────────────────────────┐
│    おはようございます！         │
│  今日の調子を教えてください     │
├─────────────────────────────┤
│                             │
│  今朝の気分は？              │
│  ┌────┬────┬────┐        │
│  │ 😊  │ 😐  │ 😔  │        │
│  │調子 │普通 │疲れ │        │
│  │いい │    │てる │        │
│  └────┴────┴────┘        │
│                             │
│  疲労度は？                  │
│  1 ━━━●━━━ 5              │
│  軽い      重い              │
│                             │
│  睡眠の質は？                │
│  ┌────┬────┬────┐        │
│  │ ⭐️  │ ☁️  │ 💤  │        │
│  │ぐっ │普通 │浅い │        │
│  │すり │    │    │        │
│  └────┴────┴────┘        │
│                             │
│  昨晩お酒を飲みましたか？      │
│  ┌──────┬──────┐          │
│  │ 🍺 はい │ ❌ いいえ│          │
│  └──────┴──────┘          │
│  [グラス数: ① ② ③ ④+]      │
│                             │
├─────────────────────────────┤
│  [スキップ]    [完了] →     │
└─────────────────────────────┘
```

---

### 4. プロフィール画面（Me） - Phase 1 + Phase 2 拡張

```
┌─────────────────────────────┐
│  [アイコン]  まさかず         │
│              28歳 / 男性     │
├─ デバイス情報 ──────────────┤
│  ⌚️ Apple Watch Series 9    │
│  ✅ 接続済み                 │
│  📊 詳細データ収集中          │
├─ 基本情報 ─────────────────┤
│  身長: 175cm / 体重: 70kg    │
│  安静時心拍: 65bpm          │
├─ 目標 ────────────────────┤
│  ✓ 疲労回復                  │
│  ✓ 集中力向上                │
├─ 食事設定 ─────────────────┤
│  好み: 和食                  │
│  制限: グルテンフリー         │
├─ 運動習慣 ─────────────────┤
│  筋トレ: 週5-6回             │
│  有酸素: 週3回               │
├─ 環境設定 ─────────────────┤
│  花粉アレルギー: あり（スギ）  │
│  気圧敏感度: 高い            │
├─ 通知設定 ─────────────────┤
│  毎朝: 6:00                  │
│  クイックチェックイン: オン    │
├─ 言語設定 ─────────────────┤
│  🇯🇵 日本語 / 🇺🇸 English      │
├─────────────────────────────┤
│  [プロフィールを編集]         │
│  [設定]                      │
└─────────────────────────────┘
```

---

## 🎨 デザイン仕様

### カラーパレット

- **プライマリ**: ソフトグリーン `#4ECDC4`
- **セカンダリ**: ウォームベージュ `#F7F3E9`
- **アクセント**: サンセットオレンジ `#FF6B6B`
- **警告**: アンバー `#FFA500`
- **テキスト**: ダークグレー `#2C3E50`
- **背景**: 白 `#FFFFFF` / ダーク `#1E1E1E`

### タイポグラフィ

- **見出し**: SF Pro Display (Bold)
- **本文**: SF Pro Text (Regular)
- **数字**: SF Pro Rounded

### UI コンポーネント

- **カード角丸**: 16pt
- **影**: `(0, 2, 8, rgba(0,0,0,0.08))`
- **パディング**: 16pt
- **アイコン**: SF Symbols 24x24pt

### 環境アラートカードのデザイン

```
┌─────────────────────────────┐
│ ⚠️ 気圧が急降下              │
│ 995hPa（-15hPa/24h）        │
│ 頭痛に注意 → 詳細を見る      │
└─────────────────────────────┘
背景色: #FFF3CD（薄い黄色）
ボーダー: #FFA500（警告オレンジ）
```

---

## 🔔 通知仕様

### 毎朝の定期通知

**日本語メッセージ（ランダムバリエーション）:**

1. おはようございます！今日のアドバイス準備できました
2. 今日も健康的な 1 日を！
3. あなたの今日の Tempo、確認しましょう
4. 今日のコンディション、チェックしてみませんか？
5. さあ、今日を最適化しましょう

**英語メッセージ（ランダムバリエーション）:**

1. Good morning! Your daily advice is ready
2. Let's make today healthy!
3. Check your Tempo for today
4. Ready to optimize your day?
5. Your personalized health tips are waiting

**Phase 2 追加:**

- 通知タップ後に「クイックチェックイン」画面を表示

**設定:**

- デフォルト時刻: 6:00（ユーザー変更可能）
- 曜日選択可能（デフォルト: 毎日）
- **通知メッセージは設定言語で表示**

---

## 🎯 ユーザーフロー

### 初回起動

```
アプリ起動
  ↓
オンボーディング（3-4画面）
  ↓
権限リクエスト（HealthKit / 位置情報 / 通知）
  ↓
Apple Watch検出
  ↓
プロフィール設定（拡充版）
  - 基本情報
  - 目標
  - 食事設定
  - 花粉アレルギー
  - 気圧敏感度
  ↓
初回分析実行（10-15秒）
  ↓
ホーム画面
```

### 毎日の利用（Phase 2）

```
起床
  ↓
通知受信
  ↓
通知タップ
  ↓
クイックチェックイン（30秒、スキップ可）
  ↓
アプリ起動
  ↓
「分析中...」（10-15秒）
  - HealthKitデータ収集
  - 環境データ取得（気圧、UV、花粉、AQI）
  - チェックイン結果を統合
  ↓
今日のアドバイス表示
  - 環境アラート表示（該当時）
  - パーソナライズされたアドバイス
  ↓
「詳細を見る」（任意）
```

---

## 📊 データプライバシー

### 収集データ

- **HealthKit**: 睡眠、HRV、心拍、歩数、血中酸素、呼吸数など
- **位置情報**: 天気・環境データ取得のみ（保存しない）
- **プロフィール**: サーバーに暗号化保存
- **クイックチェックイン**: 当日のみ保存、翌日削除

### データ保護

- HealthKit データはデバイスに保存されたまま
- 分析時のみサーバー送信、即座に削除
- アドバイスは 7 日間のみ保存、8 日目に自動削除
- 第三者共有なし
- クイックチェックインデータは匿名化

---

## 🚀 リリースフェーズ

### Phase 1: MVP（Week 1-2） - 最優先

**目標**: 1 回でもアドバイスを見れる

**既存機能:**

- ✅ HealthKit データ取得（基本）
- ✅ 天気 API 統合
- ✅ Claude API 統合
- ✅ ホーム画面
- ✅ 詳細アドバイス画面
- ✅ 通知機能
- ✅ 基本プロフィール設定

**Phase 1 で追加:**

- ✅ **HealthKit 拡充**: 安静時心拍数、血中酸素、呼吸数
- ✅ **Apple Watch 自動検出**
- ✅ **環境データ拡充**: 気圧、UV、日の出/入
- ✅ **環境アラートカード**

**成果物**: より詳細なバイタルと環境を考慮したアドバイス

---

### Phase 2: UX 改善 + 機能拡張（Week 3-4）

**目標**: 毎日使いたくなる

**既存機能:**

- ✅ UI の洗練
- ✅ プロンプト精度向上
- ✅ エラーハンドリング
- ✅ ローディング改善
- ✅ プロフィール詳細設定
- ✅ オンボーディング改善

**Phase 2 で追加:**

- ✅ **クイックチェックイン機能**
- ✅ **HealthKit 追加データ**: 体温、マインドフルネス時間、立ち上がり回数
- ✅ **環境データ追加**: 花粉情報、大気質指数（AQI）
- ✅ **プロフィール拡充**: 花粉アレルギー、気圧敏感度設定

**成果物**: 快適な UX で継続使用、よりパーソナライズされたアドバイス

---

### Phase 3: 履歴機能（Week 5-6）

**目標**: 振り返りができる

- ✅ Supabase データベース統合
- ✅ 履歴画面（7 日間）
- ✅ データ永続化
- ✅ 環境データの履歴表示

**成果物**: 過去の傾向と環境要因の相関を確認できる

---

### Phase 4: 分析・拡張（Week 7-8+）

**目標**: より深い洞察

- ✅ トレンドグラフ
- ✅ パターン分析
- ✅ 環境要因と体調の相関分析
- ✅ Apple Watch 対応（詳細）
- ✅ App Store 準備

**成果物**: リリース準備完了

---

## 🔧 技術スタック

### iOS アプリ

- **言語**: Swift 5.9+
- **フレームワーク**: SwiftUI (iOS 16.0+)
- **ヘルスデータ**: HealthKit
- **ウェアラブル**: WatchConnectivity（Apple Watch 検出・連携）
- **位置情報**: CoreLocation
- **通知**: UserNotifications

### バックエンド API

- **プラットフォーム**: Cloudflare Workers
- **フレームワーク**: Hono (軽量 TypeScript)
- **AI**: Claude API (Anthropic)

### 外部 API

- **天気・環境**: Open-Meteo API
  - 気温、天気、湿度
  - **気圧**
  - **UV 指数**
  - **日の出/日の入り時刻**
  - **花粉情報**（Open-Meteo Pollen）
- **大気質**: IQAir API または OpenWeatherMap Air Pollution API

### データベース・インフラ

- **データベース**: PostgreSQL (Supabase)
- **接続最適化**: Hyperdrive
- **API ホスティング**: Cloudflare Workers
- **バージョン管理**: GitHub

---

## 🌐 多言語対応

### サポート言語（Phase 1）

- 🇺🇸 **英語**（デフォルト）
- 🇯🇵 **日本語**

### ユーザー体験

**初回起動時の言語自動検出:**

- デバイス言語を検出し、アプリ言語を自動設定
- プロフィール画面から手動切り替え可能

**多言語対応箇所:**

- アプリ内の全 UI
- オンボーディング画面
- 通知メッセージ
- AI が生成するアドバイス
- エラーメッセージ
- **環境アラート**

---

## 💰 ビジネスモデル（将来検討）

### オプション 1: フリーミアム

- **無料**: 基本機能、7 日間履歴、環境データ
- **Pro** ($9.99/月):
  - 30 日履歴
  - 詳細分析
  - Apple Watch 詳細機能
  - 血液検査データ統合（Phase 5）

### オプション 2: 完全有料

- 7 日間無料トライアル
- $4.99/月 または $49.99/年

---

## 📈 成功指標（KPI）

### エンゲージメント

- DAU（Daily Active Users）
- 通知開封率
- **クイックチェックイン完了率**
- アドバイス詳細閲覧率
- 継続率（7 日、30 日）

### 品質

- アドバイス精度（ユーザーフィードバック）
- **環境アラートの適合性**
- アプリクラッシュ率
- API 応答速度

### デバイス

- **Apple Watch 装着率**
- **Apple Watch 装着時のエンゲージメント向上率**

---

## 🔮 将来の拡張

### Phase 5（3-6 ヶ月後）

- 血液検査データ統合
- 食事記録機能
- スペイン語対応
- **持続血糖モニター（CGM）連携**

### Phase 6（6-12 ヶ月後）

- パーソナルコーチング
- 週次振り返り
- フランス語・ドイツ語対応
- **体組成計連携**

---

**最終更新: 2024 年 12 月 5 日**  
**バージョン: 1.2**

- HealthKit データ拡充（安静時心拍数、血中酸素、呼吸数、体温など）
- 環境データ強化（気圧、UV、花粉、AQI、日の出/入）
- クイックチェックイン機能追加
- Apple Watch 自動検出・最適化
- プロフィール設定拡充

---
