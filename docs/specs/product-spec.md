# Tempo AI プロダクト仕様書

**バージョン**: 5.0  
**最終更新日**: 2025 年 12 月 19 日

---

## 1. プロダクト概要

### 1.1 コンセプト

**「自分のテンポで、健やかな毎日を」**

Tempo AI は、HealthKit データと気象・環境データを AI が分析し、**その日の過ごし方**をパーソナライズしてアドバイスするヘルスケアアプリです。

### 1.2 ターゲットユーザー

- 健康意識があり、データに基づくヘルスケアに興味がある
- Apple Watch または iPhone でヘルスケアデータを記録している

### 1.3 重要な制約

**医学的なアドバイス・診断は絶対に行わない**

---

## 2. 画面構成

| タブ   | 役割                         |
| ------ | ---------------------------- |
| ホーム | 今日のアドバイス、トライ提案 |
| リズム | 健康状態のダッシュボード     |
| 設定   | プロフィール編集、各種設定   |

---

## 3. 機能要件

### 3.1 メインアドバイス機能

#### 生成タイミング

| 条件                     | 動作                   |
| ------------------------ | ---------------------- |
| その日初めてアプリを起動 | アドバイスを新規生成   |
| 同日中に再度起動         | キャッシュを表示       |
| オフライン時             | 前日のアドバイスを表示 |

#### アドバイスの構成要素

| セクション                       | 長さ目安                           |
| -------------------------------- | ---------------------------------- |
| 挨拶                             | 1 文                               |
| コンディション概要（ホーム用）   | 3-4 文                             |
| コンディション詳細（詳細画面用） | 8-12 文                            |
| 今日のトライ                     | タイトル 15 文字以内 + 詳細 3-5 文 |
| お見送りメッセージ               | 1-2 文                             |

※ 詳細な出力形式は [ai-prompt-spec.md](./ai-prompt-spec.md) を参照

### 3.2 今日のトライ機能

| 項目           | 内容                             |
| -------------- | -------------------------------- |
| 難易度         | 低（5-15 分で完結）              |
| 多様性         | 過去 2 週間と重複しない          |
| パーソナライズ | 「なぜ今日これなのか」を必ず明示 |

### 3.3 関心ごとタグ機能

**6 カテゴリー**: エネルギー、栄養、運動、メンタル、美容、睡眠

| 項目           | 内容                     |
| -------------- | ------------------------ |
| 選択数         | 1〜3 個（必須）          |
| 設定タイミング | 初回オンボーディング時   |
| 変更           | 設定画面からいつでも可能 |

---

## 4. サーカディアンリズム画面

### 4.1 核心コンセプト: 自律神経の三角形

※ 詳細なアルゴリズムは [metrics-spec.md](./metrics-spec.md) セクション 1 を参照

```
        HRV（結果 = 今日のコンディション）
           ▲
          / \
         /   \
        /     \
       ▼───────▼
    睡眠      歩数
   （回復）  （活動）
```

### 4.2 画面構成要素

| 要素                    | 内容                                 |
| ----------------------- | ------------------------------------ |
| 24 時間サークル図 + HRV | サークル中央に HRV 値を大きく表示    |
| 3 つの指標              | HRV・睡眠・歩数の三角形              |
| リズム安定度            | ステータス + インジケーター + 説明文 |
| AI の見立て             | 3-5 文の統合解釈                     |

※ UI 詳細は [ui-spec.md](./ui-spec.md) セクション 5 を参照  
※ スコア算出は [metrics-spec.md](./metrics-spec.md) を参照

### 4.3 詳細画面（v1.1 予定）

MVP スコープ外。v1.1 で「あなたのパターン」「リズムを整えるヒント」を実装予定。

---

## 5. データ要件

### 5.1 HealthKit（必須）

| データ種別   | 用途                   |
| ------------ | ---------------------- |
| HRV          | 自律神経バランス評価   |
| 睡眠分析     | 睡眠時間、睡眠ステージ |
| 歩数         | 活動量評価             |
| 安静時心拍数 | 回復度評価             |

### 5.2 環境データ

| データ種別       | 用途               |
| ---------------- | ------------------ |
| 気温・湿度・気圧 | 体調への影響評価   |
| 天気・UV 指数    | 外出アドバイス     |
| AQI・PM2.5       | 大気汚染アドバイス |

---

## 6. オンボーディングフロー

1. ウェルカム画面
2. ニックネーム入力（必須）
3. 基本情報入力（年齢・性別・体重・身長）
4. 職業・生活習慣（任意）
5. 関心ごとタグ選択（1-3 個、必須）
6. 権限リクエスト（HealthKit・位置情報）
7. データ取得中
8. ホーム画面

---

## 7. エラーハンドリング

| エラーケース         | 対応                                |
| -------------------- | ----------------------------------- |
| オフライン           | 前日のアドバイス表示                |
| HealthKit データ不足 | 一般的なアドバイス + 説明メッセージ |
| 気象データ取得失敗   | 気象関連を省略して生成              |
| Claude API エラー    | フォールバックアドバイス表示        |
| 位置情報取得失敗     | 都市手動選択ダイアログ              |

※ エラー画面 UI は [ui-spec.md](./ui-spec.md) セクション 7 を参照

---

## 8. プライバシー

| 原則           | 内容                             |
| -------------- | -------------------------------- |
| データ最小化   | 必要最小限のみ取得               |
| デバイス内処理 | HealthKit データはデバイス内のみ |
| 匿名化         | AI 送信時は個人識別情報を除外    |

---

## 9. MVP スコープ

### 含まれる機能

- オンボーディング
- HealthKit 基本データ取得
- 気象・大気汚染データ統合
- 毎朝のメインアドバイス生成
- 今日のトライ提案
- サーカディアンリズム画面
- 設定画面

### v1.1 以降に延期

- 詳細画面（散布図 + ヒント）
- プッシュ通知
- 過去のアドバイス履歴
- ダークモード

---

## 関連ドキュメント

| ドキュメント                             | 内容                   |
| ---------------------------------------- | ---------------------- |
| [ui-spec.md](./ui-spec.md)               | UI/UX 設計             |
| [metrics-spec.md](./metrics-spec.md)     | スコア算出アルゴリズム |
| [ai-prompt-spec.md](./ai-prompt-spec.md) | AI プロンプト仕様      |
| [phases.md](../phases/phases.md)         | 開発フェーズ管理       |
