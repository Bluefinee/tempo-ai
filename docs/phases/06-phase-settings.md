# Phase 6: 設定画面 UI 設計書

**フェーズ**: 6 / 15  
**Part**: A（iOS UI）  
**前提フェーズ**: Phase 2（タブバー）

---

## ⚠️ 実装前必読ドキュメント

**実装を開始する前に、以下のドキュメントを必ず確認してください：**

### 📋 必須参考資料

- **[CLAUDE.md](../../CLAUDE.md)** - 開発ガイドライン・基本原則
- **[AI Prompt Design](../ai-prompt-design.md)** - AI 設計指針
- **[UI Specification](../ui-spec.md)** - UI 設計仕様書
- **[Technical Specification](../technical-spec.md)** - 技術仕様書

### 📱 Swift/iOS 専用資料

- **[UX Concepts & Principles](../../.claude/ux_concepts.md)** - UX 設計原則
- **[Swift Coding Standards](../../.claude/swift-coding-standards.md)** - Swift 開発標準

### ✅ 実装完了後の必須作業

実装完了後は必ず以下を実行してください：

```bash
# リント・フォーマット確認
swiftlint
swift-format --lint --recursive ios/

# テスト実行
swift test
```

---

## このフェーズで実現すること

1. **設定トップ画面**の実装
2. **プロフィール編集画面**の実装
3. **関心ごとタグ編集画面**の実装
4. **データとプライバシー画面**の実装
5. **アプリについて画面**の実装

---

## 完了条件

- [ ] タブバーの設定タブから設定トップ画面が表示される
- [ ] プロフィール編集で情報を変更し、保存できる
- [ ] 関心ごとタグを変更し、保存できる
- [ ] データとプライバシー画面で説明が表示される
- [ ] アプリについて画面でバージョン情報が表示される
- [ ] 変更内容が UserDefaults に正しく保存される

---

## 画面一覧

| 画面                 | 遷移元     | 主な機能                       |
| -------------------- | ---------- | ------------------------------ |
| 設定トップ           | タブバー   | 各設定項目へのナビゲーション   |
| プロフィール編集     | 設定トップ | 基本情報・職業・生活習慣の編集 |
| 関心ごとタグ編集     | 設定トップ | タグ（1〜3 個）の変更          |
| データとプライバシー | 設定トップ | データ取り扱いの説明           |
| アプリについて       | 設定トップ | バージョン情報、ライセンス     |

---

## 設定トップ画面

### 画面構成

```
┌─────────────────────────────────────┐
│ 設定                                │ ← ナビゲーションバー
├─────────────────────────────────────┤
│                                     │
│ アカウント                          │ ← セクション見出し
│                                     │
│ ┌─────────────────────────────┐    │
│ │ 👤 プロフィール          >  │    │
│ └─────────────────────────────┘    │
│                                     │
│ ┌─────────────────────────────┐    │
│ │ 🏷️ 関心ごとタグ          >  │    │
│ └─────────────────────────────┘    │
│                                     │
│ その他                              │ ← セクション見出し
│                                     │
│ ┌─────────────────────────────┐    │
│ │ 🔒 データとプライバシー    >  │    │
│ └─────────────────────────────┘    │
│                                     │
│ ┌─────────────────────────────┐    │
│ │ ℹ️ アプリについて          >  │    │
│ └─────────────────────────────┘    │
│                                     │
├─────────────────────────────────────┤
│ タブバー                            │
│ [ホーム]  [コンディション]  [設定]  │ ← 3タブ構成
└─────────────────────────────────────┘
```

### 構成要素

- セクション見出し: 「アカウント」「その他」
- 各項目はリスト形式
- アイコン + ラベル + chevron（>）
- タップで各画面へ遷移

---

## プロフィール編集画面

### 画面構成

```
┌─────────────────────────────────────┐
│ [←] プロフィール        [保存]      │
├─────────────────────────────────────┤
│                                     │
│ 基本情報                            │
│                                     │
│ ニックネーム                        │
│ ┌─────────────────────────────┐    │
│ │ マサ                        │    │
│ └─────────────────────────────┘    │
│                                     │
│ 年齢                                │
│ ┌─────────────────────────────┐    │
│ │ 28                          │    │
│ └─────────────────────────────┘    │
│                                     │
│ 性別                                │
│ ┌─────────────────────────────┐    │
│ │ 男性                      ▼ │    │
│ └─────────────────────────────┘    │
│                                     │
│ 体重 (kg)                           │
│ ┌─────────────────────────────┐    │
│ │ 70                          │    │
│ └─────────────────────────────┘    │
│                                     │
│ 身長 (cm)                           │
│ ┌─────────────────────────────┐    │
│ │ 175                         │    │
│ └─────────────────────────────┘    │
│                                     │
├─────────────────────────────────────┤
│                                     │
│ 職業・生活習慣（任意）              │
│                                     │
│ 職業カテゴリー                      │
│ ┌─────────────────────────────┐    │
│ │ ITエンジニア・デスクワーク ▼│    │
│ └─────────────────────────────┘    │
│                                     │
│ 生活リズム                          │
│ ┌─────────────────────────────┐    │
│ │ 夜型                      ▼ │    │
│ └─────────────────────────────┘    │
│                                     │
│ 運動習慣                            │
│ ┌─────────────────────────────┐    │
│ │ ほぼ毎日                  ▼ │    │
│ └─────────────────────────────┘    │
│                                     │
│ 飲酒習慣                            │
│ ┌─────────────────────────────┐    │
│ │ 週1-2回                   ▼ │    │
│ └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 編集項目

**基本情報（必須）**:

- ニックネーム（テキスト入力）
- 年齢（数値入力）
- 性別（選択式）
- 体重（数値入力）
- 身長（数値入力）

**職業・生活習慣（任意）**:

- 職業カテゴリー（選択式）
- 生活リズム（選択式）
- 運動習慣（選択式）
- 飲酒習慣（選択式）

### バリデーション

オンボーディング（Phase 1）と同じルールを適用:

- ニックネーム: 1 文字以上
- 年齢: 1〜120
- 体重: 20〜300 kg
- 身長: 50〜250 cm

### 保存動作

- 「保存」ボタンタップで UserDefaults に保存
- 保存成功時は前の画面に戻る
- バリデーションエラー時は保存しない（エラー表示）

---

## 関心ごとタグ編集画面

### 画面構成

```
┌─────────────────────────────────────┐
│ [←] 関心ごとタグ        [保存]      │
├─────────────────────────────────────┤
│                                     │
│ あなたの関心ごとを選んでください    │
│ （1〜3個）                          │
│                                     │
│ ┌───────────────┐ ┌───────────────┐│
│ │      ✓       │ │               ││
│ │ エネルギー・  │ │   栄養・     ││
│ │パフォーマンス │ │   食事       ││
│ │               │ │               ││
│ └───────────────┘ └───────────────┘│
│                                     │
│ ┌───────────────┐ ┌───────────────┐│
│ │               │ │      ✓       ││
│ │   運動・      │ │ メンタル・   ││
│ │フィットネス   │ │ ストレス     ││
│ │               │ │               ││
│ └───────────────┘ └───────────────┘│
│                                     │
│ ┌───────────────┐ ┌───────────────┐│
│ │               │ │      ✓       ││
│ │   美容・      │ │   睡眠       ││
│ │ スキンケア    │ │               ││
│ │               │ │               ││
│ └───────────────┘ └───────────────┘│
│                                     │
└─────────────────────────────────────┘
```

### タグ一覧

| タグ                       | 説明                                 |
| -------------------------- | ------------------------------------ |
| エネルギー・パフォーマンス | 仕事や運動のパフォーマンス向上       |
| 栄養・食事                 | 食事や栄養に関するアドバイス         |
| 運動・フィットネス         | 運動やトレーニングに関するアドバイス |
| メンタル・ストレス         | ストレス管理やメンタルヘルス         |
| 美容・スキンケア           | 肌ケアや美容に関するアドバイス       |
| 睡眠                       | 睡眠の質向上に関するアドバイス       |

### インタラクション

- オンボーディング（Phase 1）と同じ UI
- タップで選択/解除
- 1〜3 個の範囲で選択可能
- 選択中のタグにはチェックマーク

### 保存動作

- 「保存」ボタンタップで UserDefaults に保存
- 最低 1 個選択されていない場合は保存不可

---

## データとプライバシー画面

### 画面構成

```
┌─────────────────────────────────────┐
│ [←] データとプライバシー            │
├─────────────────────────────────────┤
│                                     │
│ Tempo AIでのデータの取り扱い        │
│                                     │
│ ┌─────────────────────────────┐    │
│ │ 📱 ヘルスケアデータ          │    │
│ │                             │    │
│ │ 睡眠、心拍数、運動などの    │    │
│ │ データはお使いのデバイス内   │    │
│ │ にのみ保存されます。         │    │
│ │ サーバーには送信されません。 │    │
│ └─────────────────────────────┘    │
│                                     │
│ ┌─────────────────────────────┐    │
│ │ 📍 位置情報                  │    │
│ │                             │    │
│ │ 天気情報の取得にのみ使用し、 │    │
│ │ 都市レベルの精度です。       │    │
│ │ 詳細な位置は保存しません。   │    │
│ └─────────────────────────────┘    │
│                                     │
│ ┌─────────────────────────────┐    │
│ │ 🤖 AIへの送信データ          │    │
│ │                             │    │
│ │ アドバイス生成時に以下を     │    │
│ │ 送信します:                  │    │
│ │ ・ニックネーム               │    │
│ │ ・年齢、性別、体重、身長     │    │
│ │ ・職業、生活習慣             │    │
│ │ ・関心ごとタグ               │    │
│ │ ・健康データ（数値のみ）     │    │
│ │ ・気象データ                 │    │
│ │                             │    │
│ │ 本名やメールアドレスは       │    │
│ │ 送信しません。               │    │
│ └─────────────────────────────┘    │
│                                     │
│ ┌─────────────────────────────┐    │
│ │ プライバシーポリシー      >  │    │
│ └─────────────────────────────┘    │
│                                     │
│ ┌─────────────────────────────┐    │
│ │ 利用規約                  >  │    │
│ └─────────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 構成要素

- データ取り扱いの説明（3 セクション）
- プライバシーポリシーへのリンク
- 利用規約へのリンク

### リンク先

- プライバシーポリシー: Web ページを開く（SafariViewController または外部ブラウザ）
- 利用規約: 同上

※ MVP 段階ではリンク先 URL はプレースホルダー

---

## アプリについて画面

### 画面構成

```
┌─────────────────────────────────────┐
│ [←] アプリについて                  │
├─────────────────────────────────────┤
│                                     │
│           [アプリアイコン]          │
│                                     │
│           Tempo AI                  │
│           バージョン 1.0.0          │
│                                     │
├─────────────────────────────────────┤
│                                     │
│ 「あなたのテンポで、健やかな毎日を」│
│                                     │
│ Tempo AIは、あなたの生体リズム・    │
│ 活動量・回復速度などのヘルスケア    │
│ データと、気象・環境データを        │
│ 組み合わせてAIが分析し、その日の    │
│ 過ごし方をパーソナライズして        │
│ アドバイスするアプリです。          │
│                                     │
├─────────────────────────────────────┤
│                                     │
│ ┌─────────────────────────────┐    │
│ │ オープンソースライセンス  >  │    │
│ └─────────────────────────────┘    │
│                                     │
│ ┌─────────────────────────────┐    │
│ │ お問い合わせ              >  │    │
│ └─────────────────────────────┘    │
│                                     │
│                                     │
│           © 2025 Tempo AI           │
│                                     │
└─────────────────────────────────────┘
```

### 構成要素

- アプリアイコン（大きめ）
- アプリ名
- バージョン番号（Bundle Version）
- キャッチコピー
- アプリの説明
- オープンソースライセンス（使用ライブラリ一覧）
- お問い合わせ（メールアプリを開く）
- コピーライト

---

## 実装コンポーネント

### Views（Features/Settings/Views/）

- `SettingsView` - 設定トップ画面
- `ProfileEditView` - プロフィール編集画面
- `InterestsEditView` - 関心ごとタグ編集画面
- `PrivacyView` - データとプライバシー画面
- `AboutView` - アプリについて画面

### Shared Components

- `SettingsRow` - 設定項目の行（アイコン + ラベル + chevron）
- `SettingsSection` - 設定セクションのグループ
- `TagSelectionGrid` - タグ選択グリッド（オンボーディングと共有）

---

## 画面遷移

```
タブバー（設定タブ）
    │
    ↓
SettingsView（設定トップ）
    │
    ├─ [プロフィール] → ProfileEditView
    │                      │
    │                      └─ [保存] → SettingsView
    │
    ├─ [関心ごとタグ] → InterestsEditView
    │                      │
    │                      └─ [保存] → SettingsView
    │
    ├─ [データとプライバシー] → PrivacyView
    │                              │
    │                              ├─ [プライバシーポリシー] → Safari
    │                              └─ [利用規約] → Safari
    │
    └─ [アプリについて] → AboutView
                             │
                             ├─ [ライセンス] → LicenseView
                             └─ [お問い合わせ] → メールアプリ
```

---

## データの永続化

### 保存タイミング

- プロフィール編集: 「保存」ボタンタップ時
- 関心ごとタグ編集: 「保存」ボタンタップ時

### 保存先

- UserDefaults（CacheManager を通じて）
- キー: `userProfile`

### 読み込み

- 画面表示時に UserDefaults から読み込み
- 現在の値をフォームに反映

---

## カラー適用

| 要素                  | カラー             |
| --------------------- | ------------------ |
| 背景                  | Primary Background |
| カード/セクション背景 | Card Background    |
| 項目ラベル            | Primary Text       |
| 説明テキスト          | Secondary Text     |
| chevron               | Tertiary Text      |
| 選択中タグ            | Primary Color      |
| 保存ボタン            | Accent Color       |

---

## UI/UX ポイント

### 設定トップ

- シンプルなリスト形式
- 各項目が何を設定できるか直感的に分かる

### 編集画面

- 入力フィールドは十分な大きさ
- 選択式はピッカーまたはドロップダウン
- 「保存」ボタンは右上に配置

### プライバシー説明

- ユーザーの不安を和らげる丁寧な説明
- データの取り扱いを明確に

---

## 今後のフェーズとの関係

### トラベルモード追加時（Phase 16 以降）

設定トップ画面に「モード」セクションを追加:

```
┌─────────────────────────────────────┐
│ モード                              │ ← 新セクション
│ ┌─────────────────────────────────┐ │
│ │ ✈️ トラベルモード          [OFF]│ │
│ │                                 │ │
│ │ 移動が多い時期に。              │ │
│ │ サーカディアンリズム調整を      │ │
│ │ 優先したアドバイスに切り替えます│ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

また、プロフィール編集画面に「拠点（ホームロケーション）」設定を追加。

---

## 関連ドキュメント

- `ui-spec.md` - セクション 8「設定画面」
- `product-spec.md` - セクション 4「ユーザープロフィール設計」
- `travel-mode-condition-spec.md` - セクション 3.5「設定画面でのトラベルモード」

---

## 改訂履歴

| バージョン | 日付       | 変更内容                                                        |
| ---------- | ---------- | --------------------------------------------------------------- |
| 1.0        | 2025-12-10 | 初版作成                                                        |
| 1.1        | 2025-12-11 | タブバーを 3 タブ構成に変更、トラベルモード追加時の変更点を記載 |
